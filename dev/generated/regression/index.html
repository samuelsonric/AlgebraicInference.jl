<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · AlgebraicInference.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">AlgebraicInference.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">AlgebraicInference.jl</a></li><li class="is-active"><a class="tocitem" href>Examples</a></li><li><a class="tocitem" href="../../api/">Library Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/samuelsonric/AlgebraicInference.jl/blob/master/docs/literate/regression.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Bayesian-Linear-Regression"><a class="docs-heading-anchor" href="#Bayesian-Linear-Regression">Bayesian Linear Regression</a><a id="Bayesian-Linear-Regression-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian-Linear-Regression" title="Permalink"></a></h1><pre><code class="language-julia hljs">using AlgebraicInference
using Cairo
using Catlab, Catlab.Theories, Catlab.Graphics, Catlab.Programs
using Convex
using DataFrames
using Fontconfig
using Gadfly
using LinearAlgebra: I
using SCS
using TikzPictures</code></pre><p>The diagram <code>update_diagram</code> represents the posterior distribution of a Bayesian linear regression model.</p><pre><code class="language-julia hljs">const F = FreeAbelianBicategoryRelations

input_space  = Ob(F, :input_space)
output_space = Ob(F, :output_space)
input        = Hom(:input, input_space, output_space)
output       = Hom(:output, mzero(F.Ob), output_space)
error        = Hom(:error, mzero(F.Ob), output_space)
weights      = Hom(:weights, mzero(F.Ob), input_space)

update_diagram = (
    weights
    ⋅ Δ(input_space)
    ⋅ (error ⊕ input ⊕ id(input_space))
    ⋅ (plus(output_space) ⊕ id(input_space))
    ⋅ (output ⊕ id(output_space) ⊕ id(input_space))
    ⋅ (dcounit(output_space) ⊕ id(input_space))
)

to_tikz(update_diagram; base_unit=&quot;8mm&quot;)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="476.818pt" height="226.772pt" viewBox="0 0 476.818 226.772" version="1.1">
<defs>
<g>
<symbol overflow="visible" id="glyph-1674545912402976-0-0">
<path style="stroke:none;" d=""/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402976-0-1">
<path style="stroke:none;" d="M 6.171875 -3.34375 C 6.34375 -3.84375 6.65625 -3.984375 7.015625 -3.984375 L 7.015625 -4.296875 C 6.78125 -4.28125 6.5 -4.265625 6.28125 -4.265625 C 5.984375 -4.265625 5.546875 -4.28125 5.359375 -4.296875 L 5.359375 -3.984375 C 5.71875 -3.984375 5.9375 -3.796875 5.9375 -3.515625 C 5.9375 -3.453125 5.9375 -3.421875 5.875 -3.296875 L 4.96875 -0.75 L 3.984375 -3.53125 C 3.953125 -3.65625 3.9375 -3.671875 3.9375 -3.71875 C 3.9375 -3.984375 4.328125 -3.984375 4.53125 -3.984375 L 4.53125 -4.296875 C 4.234375 -4.28125 3.734375 -4.265625 3.484375 -4.265625 C 3.1875 -4.265625 2.90625 -4.28125 2.609375 -4.296875 L 2.609375 -3.984375 C 2.96875 -3.984375 3.125 -3.96875 3.234375 -3.84375 C 3.28125 -3.78125 3.390625 -3.484375 3.453125 -3.296875 L 2.609375 -0.875 L 1.65625 -3.53125 C 1.609375 -3.65625 1.609375 -3.671875 1.609375 -3.71875 C 1.609375 -3.984375 2 -3.984375 2.1875 -3.984375 L 2.1875 -4.296875 C 1.890625 -4.28125 1.328125 -4.265625 1.109375 -4.265625 C 1.0625 -4.265625 0.53125 -4.28125 0.171875 -4.296875 L 0.171875 -3.984375 C 0.671875 -3.984375 0.796875 -3.953125 0.921875 -3.640625 L 2.171875 -0.109375 C 2.21875 0.03125 2.25 0.109375 2.375 0.109375 C 2.515625 0.109375 2.53125 0.046875 2.578125 -0.09375 L 3.59375 -2.90625 L 4.609375 -0.078125 C 4.640625 0.03125 4.671875 0.109375 4.8125 0.109375 C 4.9375 0.109375 4.96875 0.015625 5 -0.078125 Z M 6.171875 -3.34375 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402976-0-2">
<path style="stroke:none;" d="M 1.109375 -2.515625 C 1.171875 -4 2.015625 -4.25 2.359375 -4.25 C 3.375 -4.25 3.484375 -2.90625 3.484375 -2.515625 Z M 1.109375 -2.296875 L 3.890625 -2.296875 C 4.109375 -2.296875 4.140625 -2.296875 4.140625 -2.515625 C 4.140625 -3.5 3.59375 -4.46875 2.359375 -4.46875 C 1.203125 -4.46875 0.28125 -3.4375 0.28125 -2.1875 C 0.28125 -0.859375 1.328125 0.109375 2.46875 0.109375 C 3.6875 0.109375 4.140625 -1 4.140625 -1.1875 C 4.140625 -1.28125 4.0625 -1.3125 4 -1.3125 C 3.921875 -1.3125 3.890625 -1.25 3.875 -1.171875 C 3.53125 -0.140625 2.625 -0.140625 2.53125 -0.140625 C 2.03125 -0.140625 1.640625 -0.4375 1.40625 -0.8125 C 1.109375 -1.28125 1.109375 -1.9375 1.109375 -2.296875 Z M 1.109375 -2.296875 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402976-0-3">
<path style="stroke:none;" d="M 1.765625 -4.40625 L 0.375 -4.296875 L 0.375 -3.984375 C 1.015625 -3.984375 1.109375 -3.921875 1.109375 -3.4375 L 1.109375 -0.75 C 1.109375 -0.3125 1 -0.3125 0.328125 -0.3125 L 0.328125 0 C 0.640625 -0.015625 1.1875 -0.03125 1.421875 -0.03125 C 1.78125 -0.03125 2.125 -0.015625 2.46875 0 L 2.46875 -0.3125 C 1.796875 -0.3125 1.765625 -0.359375 1.765625 -0.75 Z M 1.796875 -6.140625 C 1.796875 -6.453125 1.5625 -6.671875 1.28125 -6.671875 C 0.96875 -6.671875 0.75 -6.40625 0.75 -6.140625 C 0.75 -5.875 0.96875 -5.609375 1.28125 -5.609375 C 1.5625 -5.609375 1.796875 -5.828125 1.796875 -6.140625 Z M 1.796875 -6.140625 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402976-0-4">
<path style="stroke:none;" d="M 2.21875 -1.71875 C 1.34375 -1.71875 1.34375 -2.71875 1.34375 -2.9375 C 1.34375 -3.203125 1.359375 -3.53125 1.5 -3.78125 C 1.578125 -3.890625 1.8125 -4.171875 2.21875 -4.171875 C 3.078125 -4.171875 3.078125 -3.1875 3.078125 -2.953125 C 3.078125 -2.6875 3.078125 -2.359375 2.921875 -2.109375 C 2.84375 -2 2.609375 -1.71875 2.21875 -1.71875 Z M 1.0625 -1.328125 C 1.0625 -1.359375 1.0625 -1.59375 1.21875 -1.796875 C 1.609375 -1.515625 2.03125 -1.484375 2.21875 -1.484375 C 3.140625 -1.484375 3.828125 -2.171875 3.828125 -2.9375 C 3.828125 -3.3125 3.671875 -3.671875 3.421875 -3.90625 C 3.78125 -4.25 4.140625 -4.296875 4.3125 -4.296875 C 4.34375 -4.296875 4.390625 -4.296875 4.421875 -4.28125 C 4.3125 -4.25 4.25 -4.140625 4.25 -4.015625 C 4.25 -3.84375 4.390625 -3.734375 4.546875 -3.734375 C 4.640625 -3.734375 4.828125 -3.796875 4.828125 -4.03125 C 4.828125 -4.203125 4.71875 -4.515625 4.328125 -4.515625 C 4.125 -4.515625 3.6875 -4.453125 3.265625 -4.046875 C 2.84375 -4.375 2.4375 -4.40625 2.21875 -4.40625 C 1.28125 -4.40625 0.59375 -3.71875 0.59375 -2.953125 C 0.59375 -2.515625 0.8125 -2.140625 1.0625 -1.921875 C 0.9375 -1.78125 0.75 -1.453125 0.75 -1.09375 C 0.75 -0.78125 0.890625 -0.40625 1.203125 -0.203125 C 0.59375 -0.046875 0.28125 0.390625 0.28125 0.78125 C 0.28125 1.5 1.265625 2.046875 2.484375 2.046875 C 3.65625 2.046875 4.6875 1.546875 4.6875 0.765625 C 4.6875 0.421875 4.5625 -0.09375 4.046875 -0.375 C 3.515625 -0.640625 2.9375 -0.640625 2.328125 -0.640625 C 2.078125 -0.640625 1.65625 -0.640625 1.578125 -0.65625 C 1.265625 -0.703125 1.0625 -1 1.0625 -1.328125 Z M 2.5 1.828125 C 1.484375 1.828125 0.796875 1.3125 0.796875 0.78125 C 0.796875 0.328125 1.171875 -0.046875 1.609375 -0.0625 L 2.203125 -0.0625 C 3.0625 -0.0625 4.171875 -0.0625 4.171875 0.78125 C 4.171875 1.328125 3.46875 1.828125 2.5 1.828125 Z M 2.5 1.828125 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402976-0-5">
<path style="stroke:none;" d="M 1.09375 -0.75 C 1.09375 -0.3125 0.984375 -0.3125 0.3125 -0.3125 L 0.3125 0 C 0.671875 -0.015625 1.171875 -0.03125 1.453125 -0.03125 C 1.703125 -0.03125 2.21875 -0.015625 2.5625 0 L 2.5625 -0.3125 C 1.890625 -0.3125 1.78125 -0.3125 1.78125 -0.75 L 1.78125 -2.59375 C 1.78125 -3.625 2.5 -4.1875 3.125 -4.1875 C 3.765625 -4.1875 3.875 -3.65625 3.875 -3.078125 L 3.875 -0.75 C 3.875 -0.3125 3.765625 -0.3125 3.09375 -0.3125 L 3.09375 0 C 3.4375 -0.015625 3.953125 -0.03125 4.21875 -0.03125 C 4.46875 -0.03125 5 -0.015625 5.328125 0 L 5.328125 -0.3125 C 4.8125 -0.3125 4.5625 -0.3125 4.5625 -0.609375 L 4.5625 -2.515625 C 4.5625 -3.375 4.5625 -3.671875 4.25 -4.03125 C 4.109375 -4.203125 3.78125 -4.40625 3.203125 -4.40625 C 2.359375 -4.40625 1.921875 -3.8125 1.75 -3.421875 L 1.75 -6.921875 L 0.3125 -6.8125 L 0.3125 -6.5 C 1.015625 -6.5 1.09375 -6.4375 1.09375 -5.9375 Z M 1.09375 -0.75 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402976-0-6">
<path style="stroke:none;" d="M 1.71875 -3.984375 L 3.15625 -3.984375 L 3.15625 -4.296875 L 1.71875 -4.296875 L 1.71875 -6.125 L 1.46875 -6.125 C 1.46875 -5.3125 1.171875 -4.25 0.1875 -4.203125 L 0.1875 -3.984375 L 1.03125 -3.984375 L 1.03125 -1.234375 C 1.03125 -0.015625 1.96875 0.109375 2.328125 0.109375 C 3.03125 0.109375 3.3125 -0.59375 3.3125 -1.234375 L 3.3125 -1.796875 L 3.0625 -1.796875 L 3.0625 -1.25 C 3.0625 -0.515625 2.765625 -0.140625 2.390625 -0.140625 C 1.71875 -0.140625 1.71875 -1.046875 1.71875 -1.21875 Z M 1.71875 -3.984375 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402976-0-7">
<path style="stroke:none;" d="M 2.078125 -1.9375 C 2.296875 -1.890625 3.109375 -1.734375 3.109375 -1.015625 C 3.109375 -0.515625 2.765625 -0.109375 1.984375 -0.109375 C 1.140625 -0.109375 0.78125 -0.671875 0.59375 -1.53125 C 0.5625 -1.65625 0.5625 -1.6875 0.453125 -1.6875 C 0.328125 -1.6875 0.328125 -1.625 0.328125 -1.453125 L 0.328125 -0.125 C 0.328125 0.046875 0.328125 0.109375 0.4375 0.109375 C 0.484375 0.109375 0.5 0.09375 0.6875 -0.09375 C 0.703125 -0.109375 0.703125 -0.125 0.890625 -0.3125 C 1.328125 0.09375 1.78125 0.109375 1.984375 0.109375 C 3.125 0.109375 3.59375 -0.5625 3.59375 -1.28125 C 3.59375 -1.796875 3.296875 -2.109375 3.171875 -2.21875 C 2.84375 -2.546875 2.453125 -2.625 2.03125 -2.703125 C 1.46875 -2.8125 0.8125 -2.9375 0.8125 -3.515625 C 0.8125 -3.875 1.0625 -4.28125 1.921875 -4.28125 C 3.015625 -4.28125 3.078125 -3.375 3.09375 -3.078125 C 3.09375 -2.984375 3.1875 -2.984375 3.203125 -2.984375 C 3.34375 -2.984375 3.34375 -3.03125 3.34375 -3.21875 L 3.34375 -4.234375 C 3.34375 -4.390625 3.34375 -4.46875 3.234375 -4.46875 C 3.1875 -4.46875 3.15625 -4.46875 3.03125 -4.34375 C 3 -4.3125 2.90625 -4.21875 2.859375 -4.1875 C 2.484375 -4.46875 2.078125 -4.46875 1.921875 -4.46875 C 0.703125 -4.46875 0.328125 -3.796875 0.328125 -3.234375 C 0.328125 -2.890625 0.484375 -2.609375 0.75 -2.390625 C 1.078125 -2.140625 1.359375 -2.078125 2.078125 -1.9375 Z M 2.078125 -1.9375 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402976-0-8">
<path style="stroke:none;" d="M 1.671875 -3.3125 L 1.671875 -4.40625 L 0.28125 -4.296875 L 0.28125 -3.984375 C 0.984375 -3.984375 1.0625 -3.921875 1.0625 -3.421875 L 1.0625 -0.75 C 1.0625 -0.3125 0.953125 -0.3125 0.28125 -0.3125 L 0.28125 0 C 0.671875 -0.015625 1.140625 -0.03125 1.421875 -0.03125 C 1.8125 -0.03125 2.28125 -0.03125 2.6875 0 L 2.6875 -0.3125 L 2.46875 -0.3125 C 1.734375 -0.3125 1.71875 -0.421875 1.71875 -0.78125 L 1.71875 -2.3125 C 1.71875 -3.296875 2.140625 -4.1875 2.890625 -4.1875 C 2.953125 -4.1875 2.984375 -4.1875 3 -4.171875 C 2.96875 -4.171875 2.765625 -4.046875 2.765625 -3.78125 C 2.765625 -3.515625 2.984375 -3.359375 3.203125 -3.359375 C 3.375 -3.359375 3.625 -3.484375 3.625 -3.796875 C 3.625 -4.109375 3.3125 -4.40625 2.890625 -4.40625 C 2.15625 -4.40625 1.796875 -3.734375 1.671875 -3.3125 Z M 1.671875 -3.3125 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402976-0-9">
<path style="stroke:none;" d="M 4.6875 -2.140625 C 4.6875 -3.40625 3.703125 -4.46875 2.5 -4.46875 C 1.25 -4.46875 0.28125 -3.375 0.28125 -2.140625 C 0.28125 -0.84375 1.3125 0.109375 2.484375 0.109375 C 3.6875 0.109375 4.6875 -0.875 4.6875 -2.140625 Z M 2.5 -0.140625 C 2.0625 -0.140625 1.625 -0.34375 1.359375 -0.8125 C 1.109375 -1.25 1.109375 -1.859375 1.109375 -2.21875 C 1.109375 -2.609375 1.109375 -3.140625 1.34375 -3.578125 C 1.609375 -4.03125 2.078125 -4.25 2.484375 -4.25 C 2.921875 -4.25 3.34375 -4.03125 3.609375 -3.59375 C 3.875 -3.171875 3.875 -2.59375 3.875 -2.21875 C 3.875 -1.859375 3.875 -1.3125 3.65625 -0.875 C 3.421875 -0.421875 2.984375 -0.140625 2.5 -0.140625 Z M 2.5 -0.140625 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402976-0-10">
<path style="stroke:none;" d="M 1.09375 -3.421875 L 1.09375 -0.75 C 1.09375 -0.3125 0.984375 -0.3125 0.3125 -0.3125 L 0.3125 0 C 0.671875 -0.015625 1.171875 -0.03125 1.453125 -0.03125 C 1.703125 -0.03125 2.21875 -0.015625 2.5625 0 L 2.5625 -0.3125 C 1.890625 -0.3125 1.78125 -0.3125 1.78125 -0.75 L 1.78125 -2.59375 C 1.78125 -3.625 2.5 -4.1875 3.125 -4.1875 C 3.765625 -4.1875 3.875 -3.65625 3.875 -3.078125 L 3.875 -0.75 C 3.875 -0.3125 3.765625 -0.3125 3.09375 -0.3125 L 3.09375 0 C 3.4375 -0.015625 3.953125 -0.03125 4.21875 -0.03125 C 4.46875 -0.03125 5 -0.015625 5.328125 0 L 5.328125 -0.3125 C 4.8125 -0.3125 4.5625 -0.3125 4.5625 -0.609375 L 4.5625 -2.515625 C 4.5625 -3.375 4.5625 -3.671875 4.25 -4.03125 C 4.109375 -4.203125 3.78125 -4.40625 3.203125 -4.40625 C 2.46875 -4.40625 2 -3.984375 1.71875 -3.359375 L 1.71875 -4.40625 L 0.3125 -4.296875 L 0.3125 -3.984375 C 1.015625 -3.984375 1.09375 -3.921875 1.09375 -3.421875 Z M 1.09375 -3.421875 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402976-0-11">
<path style="stroke:none;" d="M 1.71875 -3.75 L 1.71875 -4.40625 L 0.28125 -4.296875 L 0.28125 -3.984375 C 0.984375 -3.984375 1.0625 -3.921875 1.0625 -3.484375 L 1.0625 1.171875 C 1.0625 1.625 0.953125 1.625 0.28125 1.625 L 0.28125 1.9375 C 0.625 1.921875 1.140625 1.90625 1.390625 1.90625 C 1.671875 1.90625 2.171875 1.921875 2.515625 1.9375 L 2.515625 1.625 C 1.859375 1.625 1.75 1.625 1.75 1.171875 L 1.75 -0.59375 C 1.796875 -0.421875 2.21875 0.109375 2.96875 0.109375 C 4.15625 0.109375 5.1875 -0.875 5.1875 -2.15625 C 5.1875 -3.421875 4.234375 -4.40625 3.109375 -4.40625 C 2.328125 -4.40625 1.90625 -3.96875 1.71875 -3.75 Z M 1.75 -1.140625 L 1.75 -3.359375 C 2.03125 -3.875 2.515625 -4.15625 3.03125 -4.15625 C 3.765625 -4.15625 4.359375 -3.28125 4.359375 -2.15625 C 4.359375 -0.953125 3.671875 -0.109375 2.9375 -0.109375 C 2.53125 -0.109375 2.15625 -0.3125 1.890625 -0.71875 C 1.75 -0.921875 1.75 -0.9375 1.75 -1.140625 Z M 1.75 -1.140625 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402976-0-12">
<path style="stroke:none;" d="M 3.890625 -0.78125 L 3.890625 0.109375 L 5.328125 0 L 5.328125 -0.3125 C 4.640625 -0.3125 4.5625 -0.375 4.5625 -0.875 L 4.5625 -4.40625 L 3.09375 -4.296875 L 3.09375 -3.984375 C 3.78125 -3.984375 3.875 -3.921875 3.875 -3.421875 L 3.875 -1.65625 C 3.875 -0.78125 3.390625 -0.109375 2.65625 -0.109375 C 1.828125 -0.109375 1.78125 -0.578125 1.78125 -1.09375 L 1.78125 -4.40625 L 0.3125 -4.296875 L 0.3125 -3.984375 C 1.09375 -3.984375 1.09375 -3.953125 1.09375 -3.078125 L 1.09375 -1.578125 C 1.09375 -0.796875 1.09375 0.109375 2.609375 0.109375 C 3.171875 0.109375 3.609375 -0.171875 3.890625 -0.78125 Z M 3.890625 -0.78125 "/>
</symbol>
</g>
<clipPath id="clip-1674545912402976-1">
  <path d="M 138 107 L 476.816406 107 L 476.816406 190 L 138 190 Z M 138 107 "/>
</clipPath>
</defs>
<g id="surface1">
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M -151.387344 22.678969 L -188.774062 22.678969 C -190.973281 22.678969 -192.758437 20.893812 -192.758437 18.690687 L -192.758437 -18.692125 C -192.758437 -20.891344 -190.973281 -22.6765 -188.774062 -22.6765 L -151.387344 -22.6765 C -149.188125 -22.6765 -147.402969 -20.891344 -147.402969 -18.692125 L -147.402969 18.690687 C -147.402969 20.893812 -149.188125 22.678969 -151.387344 22.678969 Z M -151.387344 22.678969 " transform="matrix(1,0,0,-1,238.11,113.386)"/>
<g style="fill:rgb(0%25,0%25,0%25);fill-opacity:1;">
  <use xlink:href="%23glyph-1674545912402976-0-1" x="51.953" y="115.877"/>
</g>
<g style="fill:rgb(0%25,0%25,0%25);fill-opacity:1;">
  <use xlink:href="%23glyph-1674545912402976-0-2" x="58.879027" y="115.877"/>
  <use xlink:href="%23glyph-1674545912402976-0-3" x="63.306425" y="115.877"/>
  <use xlink:href="%23glyph-1674545912402976-0-4" x="66.074046" y="115.877"/>
  <use xlink:href="%23glyph-1674545912402976-0-5" x="71.055366" y="115.877"/>
</g>
<g style="fill:rgb(0%25,0%25,0%25);fill-opacity:1;">
  <use xlink:href="%23glyph-1674545912402976-0-6" x="76.311655" y="115.877"/>
  <use xlink:href="%23glyph-1674545912402976-0-7" x="80.186125" y="115.877"/>
</g>
<path style="fill-rule:nonzero;fill:rgb(0%25,0%25,0%25);fill-opacity:1;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M -90.711562 -0.00071875 C -90.711562 3.132094 -93.246719 5.671156 -96.379531 5.671156 C -99.508437 5.671156 -102.0475 3.132094 -102.0475 -0.00071875 C -102.0475 -3.129625 -99.508437 -5.668688 -96.379531 -5.668688 C -93.246719 -5.668688 -90.711562 -3.129625 -90.711562 -0.00071875 Z M -90.711562 -0.00071875 " transform="matrix(1,0,0,-1,238.11,113.386)"/>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M -3.985 90.710219 L -41.371719 90.710219 C -43.570937 90.710219 -45.356094 88.925062 -45.356094 86.725844 L -45.356094 49.339125 C -45.356094 47.139906 -43.570937 45.35475 -41.371719 45.35475 L -3.985 45.35475 C -1.785781 45.35475 -0.000625 47.139906 -0.000625 49.339125 L -0.000625 86.725844 C -0.000625 88.925062 -1.785781 90.710219 -3.985 90.710219 Z M -3.985 90.710219 " transform="matrix(1,0,0,-1,238.11,113.386)"/>
<g style="fill:rgb(0%25,0%25,0%25);fill-opacity:1;">
  <use xlink:href="%23glyph-1674545912402976-0-2" x="204.875" y="47.499"/>
  <use xlink:href="%23glyph-1674545912402976-0-8" x="209.302397" y="47.499"/>
  <use xlink:href="%23glyph-1674545912402976-0-8" x="213.204763" y="47.499"/>
  <use xlink:href="%23glyph-1674545912402976-0-9" x="217.107129" y="47.499"/>
  <use xlink:href="%23glyph-1674545912402976-0-8" x="222.088449" y="47.499"/>
</g>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M -3.985 22.678969 L -41.371719 22.678969 C -43.570937 22.678969 -45.356094 20.893812 -45.356094 18.690687 L -45.356094 -18.692125 C -45.356094 -20.891344 -43.570937 -22.6765 -41.371719 -22.6765 L -3.985 -22.6765 C -1.785781 -22.6765 -0.000625 -20.891344 -0.000625 -18.692125 L -0.000625 18.690687 C -0.000625 20.893812 -1.785781 22.678969 -3.985 22.678969 Z M -3.985 22.678969 " transform="matrix(1,0,0,-1,238.11,113.386)"/>
<g style="fill:rgb(0%25,0%25,0%25);fill-opacity:1;">
  <use xlink:href="%23glyph-1674545912402976-0-3" x="203.81" y="115.744"/>
  <use xlink:href="%23glyph-1674545912402976-0-10" x="206.577621" y="115.744"/>
  <use xlink:href="%23glyph-1674545912402976-0-11" x="212.112864" y="115.744"/>
  <use xlink:href="%23glyph-1674545912402976-0-12" x="217.648107" y="115.744"/>
  <use xlink:href="%23glyph-1674545912402976-0-6" x="223.18335" y="115.744"/>
</g>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M 56.694688 34.014906 C 56.694688 37.147719 54.155625 39.686781 51.022813 39.686781 C 47.893906 39.686781 45.354844 37.147719 45.354844 34.014906 C 45.354844 30.886 47.893906 28.346937 51.022813 28.346937 C 54.155625 28.346937 56.694688 30.886 56.694688 34.014906 Z M 56.694688 34.014906 " transform="matrix(1,0,0,-1,238.11,113.386)"/>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M 143.417344 90.710219 L 106.034531 90.710219 C 103.831406 90.710219 102.050156 88.925062 102.050156 86.725844 L 102.050156 49.339125 C 102.050156 47.139906 103.831406 45.35475 106.034531 45.35475 L 143.417344 45.35475 C 145.620469 45.35475 147.401719 47.139906 147.401719 49.339125 L 147.401719 86.725844 C 147.401719 88.925062 145.620469 90.710219 143.417344 90.710219 Z M 143.417344 90.710219 " transform="matrix(1,0,0,-1,238.11,113.386)"/>
<g style="fill:rgb(0%25,0%25,0%25);fill-opacity:1;">
  <use xlink:href="%23glyph-1674545912402976-0-9" x="348.167" y="47.45"/>
  <use xlink:href="%23glyph-1674545912402976-0-12" x="353.14832" y="47.45"/>
  <use xlink:href="%23glyph-1674545912402976-0-6" x="358.683563" y="47.45"/>
  <use xlink:href="%23glyph-1674545912402976-0-11" x="362.558033" y="47.45"/>
  <use xlink:href="%23glyph-1674545912402976-0-12" x="368.093276" y="47.45"/>
  <use xlink:href="%23glyph-1674545912402976-0-6" x="373.628519" y="47.45"/>
</g>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M 0.300156 68.030531 C 21.835313 68.030531 27.2025 47.768812 45.854844 36.999281 " transform="matrix(1,0,0,-1,238.11,113.386)"/>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M 147.7025 68.030531 C 169.729844 68.030531 192.757188 56.04225 192.757188 34.014906 " transform="matrix(1,0,0,-1,238.11,113.386)"/>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M 56.991563 34.014906 C 86.636094 34.014906 95.081406 -0.00071875 124.725938 -0.00071875 C 154.499375 -0.00071875 192.757188 4.241469 192.757188 34.014906 " transform="matrix(1,0,0,-1,238.11,113.386)"/>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M 0.300156 -0.00071875 C 21.835313 -0.00071875 27.2025 20.264906 45.854844 31.030531 " transform="matrix(1,0,0,-1,238.11,113.386)"/>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M -147.106094 -0.00071875 C -129.649062 -0.00071875 -119.801406 -0.00071875 -102.348281 -0.00071875 " transform="matrix(1,0,0,-1,238.11,113.386)"/>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M -91.211562 2.983656 C -75.76625 11.901625 -63.488906 -0.00071875 -45.652969 -0.00071875 " transform="matrix(1,0,0,-1,238.11,113.386)"/>
<g clip-path="url(%23clip-1674545912402976-1)" clip-rule="nonzero">
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M -91.211562 -2.985094 C -59.231094 -21.446031 -59.606094 -68.031969 -22.676406 -68.031969 C 6.065781 -68.031969 22.284531 -68.031969 51.022813 -68.031969 C 79.765 -68.031969 95.98375 -68.031969 124.725938 -68.031969 C 151.257188 -68.031969 166.225938 -68.031969 192.757188 -68.031969 C 210.561875 -68.031969 220.60875 -68.031969 238.413438 -68.031969 " transform="matrix(1,0,0,-1,238.11,113.386)"/>
</g>
</g>
</svg>

'/><p>The diagram <code>predict_diagram</code> represents the predictive distribution of a Bayesian linear regression model.</p><pre><code class="language-julia hljs">predict_diagram = (
    weights
    ⋅ (error ⊕ input)
    ⋅ plus(output_space)
)

to_tikz(predict_diagram; base_unit=&quot;8mm&quot;)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="284.062pt" height="158.74pt" viewBox="0 0 284.062 158.74" version="1.1">
<defs>
<g>
<symbol overflow="visible" id="glyph-1674545912402977-0-0">
<path style="stroke:none;" d=""/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402977-0-1">
<path style="stroke:none;" d="M 6.171875 -3.34375 C 6.34375 -3.84375 6.65625 -3.984375 7.015625 -3.984375 L 7.015625 -4.296875 C 6.78125 -4.28125 6.5 -4.265625 6.28125 -4.265625 C 5.984375 -4.265625 5.546875 -4.28125 5.359375 -4.296875 L 5.359375 -3.984375 C 5.71875 -3.984375 5.9375 -3.796875 5.9375 -3.515625 C 5.9375 -3.453125 5.9375 -3.421875 5.875 -3.296875 L 4.96875 -0.75 L 3.984375 -3.53125 C 3.953125 -3.65625 3.9375 -3.671875 3.9375 -3.71875 C 3.9375 -3.984375 4.328125 -3.984375 4.53125 -3.984375 L 4.53125 -4.296875 C 4.234375 -4.28125 3.734375 -4.265625 3.484375 -4.265625 C 3.1875 -4.265625 2.90625 -4.28125 2.609375 -4.296875 L 2.609375 -3.984375 C 2.96875 -3.984375 3.125 -3.96875 3.234375 -3.84375 C 3.28125 -3.78125 3.390625 -3.484375 3.453125 -3.296875 L 2.609375 -0.875 L 1.65625 -3.53125 C 1.609375 -3.65625 1.609375 -3.671875 1.609375 -3.71875 C 1.609375 -3.984375 2 -3.984375 2.1875 -3.984375 L 2.1875 -4.296875 C 1.890625 -4.28125 1.328125 -4.265625 1.109375 -4.265625 C 1.0625 -4.265625 0.53125 -4.28125 0.171875 -4.296875 L 0.171875 -3.984375 C 0.671875 -3.984375 0.796875 -3.953125 0.921875 -3.640625 L 2.171875 -0.109375 C 2.21875 0.03125 2.25 0.109375 2.375 0.109375 C 2.515625 0.109375 2.53125 0.046875 2.578125 -0.09375 L 3.59375 -2.90625 L 4.609375 -0.078125 C 4.640625 0.03125 4.671875 0.109375 4.8125 0.109375 C 4.9375 0.109375 4.96875 0.015625 5 -0.078125 Z M 6.171875 -3.34375 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402977-0-2">
<path style="stroke:none;" d="M 1.109375 -2.515625 C 1.171875 -4 2.015625 -4.25 2.359375 -4.25 C 3.375 -4.25 3.484375 -2.90625 3.484375 -2.515625 Z M 1.109375 -2.296875 L 3.890625 -2.296875 C 4.109375 -2.296875 4.140625 -2.296875 4.140625 -2.515625 C 4.140625 -3.5 3.59375 -4.46875 2.359375 -4.46875 C 1.203125 -4.46875 0.28125 -3.4375 0.28125 -2.1875 C 0.28125 -0.859375 1.328125 0.109375 2.46875 0.109375 C 3.6875 0.109375 4.140625 -1 4.140625 -1.1875 C 4.140625 -1.28125 4.0625 -1.3125 4 -1.3125 C 3.921875 -1.3125 3.890625 -1.25 3.875 -1.171875 C 3.53125 -0.140625 2.625 -0.140625 2.53125 -0.140625 C 2.03125 -0.140625 1.640625 -0.4375 1.40625 -0.8125 C 1.109375 -1.28125 1.109375 -1.9375 1.109375 -2.296875 Z M 1.109375 -2.296875 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402977-0-3">
<path style="stroke:none;" d="M 1.765625 -4.40625 L 0.375 -4.296875 L 0.375 -3.984375 C 1.015625 -3.984375 1.109375 -3.921875 1.109375 -3.4375 L 1.109375 -0.75 C 1.109375 -0.3125 1 -0.3125 0.328125 -0.3125 L 0.328125 0 C 0.640625 -0.015625 1.1875 -0.03125 1.421875 -0.03125 C 1.78125 -0.03125 2.125 -0.015625 2.46875 0 L 2.46875 -0.3125 C 1.796875 -0.3125 1.765625 -0.359375 1.765625 -0.75 Z M 1.796875 -6.140625 C 1.796875 -6.453125 1.5625 -6.671875 1.28125 -6.671875 C 0.96875 -6.671875 0.75 -6.40625 0.75 -6.140625 C 0.75 -5.875 0.96875 -5.609375 1.28125 -5.609375 C 1.5625 -5.609375 1.796875 -5.828125 1.796875 -6.140625 Z M 1.796875 -6.140625 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402977-0-4">
<path style="stroke:none;" d="M 2.21875 -1.71875 C 1.34375 -1.71875 1.34375 -2.71875 1.34375 -2.9375 C 1.34375 -3.203125 1.359375 -3.53125 1.5 -3.78125 C 1.578125 -3.890625 1.8125 -4.171875 2.21875 -4.171875 C 3.078125 -4.171875 3.078125 -3.1875 3.078125 -2.953125 C 3.078125 -2.6875 3.078125 -2.359375 2.921875 -2.109375 C 2.84375 -2 2.609375 -1.71875 2.21875 -1.71875 Z M 1.0625 -1.328125 C 1.0625 -1.359375 1.0625 -1.59375 1.21875 -1.796875 C 1.609375 -1.515625 2.03125 -1.484375 2.21875 -1.484375 C 3.140625 -1.484375 3.828125 -2.171875 3.828125 -2.9375 C 3.828125 -3.3125 3.671875 -3.671875 3.421875 -3.90625 C 3.78125 -4.25 4.140625 -4.296875 4.3125 -4.296875 C 4.34375 -4.296875 4.390625 -4.296875 4.421875 -4.28125 C 4.3125 -4.25 4.25 -4.140625 4.25 -4.015625 C 4.25 -3.84375 4.390625 -3.734375 4.546875 -3.734375 C 4.640625 -3.734375 4.828125 -3.796875 4.828125 -4.03125 C 4.828125 -4.203125 4.71875 -4.515625 4.328125 -4.515625 C 4.125 -4.515625 3.6875 -4.453125 3.265625 -4.046875 C 2.84375 -4.375 2.4375 -4.40625 2.21875 -4.40625 C 1.28125 -4.40625 0.59375 -3.71875 0.59375 -2.953125 C 0.59375 -2.515625 0.8125 -2.140625 1.0625 -1.921875 C 0.9375 -1.78125 0.75 -1.453125 0.75 -1.09375 C 0.75 -0.78125 0.890625 -0.40625 1.203125 -0.203125 C 0.59375 -0.046875 0.28125 0.390625 0.28125 0.78125 C 0.28125 1.5 1.265625 2.046875 2.484375 2.046875 C 3.65625 2.046875 4.6875 1.546875 4.6875 0.765625 C 4.6875 0.421875 4.5625 -0.09375 4.046875 -0.375 C 3.515625 -0.640625 2.9375 -0.640625 2.328125 -0.640625 C 2.078125 -0.640625 1.65625 -0.640625 1.578125 -0.65625 C 1.265625 -0.703125 1.0625 -1 1.0625 -1.328125 Z M 2.5 1.828125 C 1.484375 1.828125 0.796875 1.3125 0.796875 0.78125 C 0.796875 0.328125 1.171875 -0.046875 1.609375 -0.0625 L 2.203125 -0.0625 C 3.0625 -0.0625 4.171875 -0.0625 4.171875 0.78125 C 4.171875 1.328125 3.46875 1.828125 2.5 1.828125 Z M 2.5 1.828125 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402977-0-5">
<path style="stroke:none;" d="M 1.09375 -0.75 C 1.09375 -0.3125 0.984375 -0.3125 0.3125 -0.3125 L 0.3125 0 C 0.671875 -0.015625 1.171875 -0.03125 1.453125 -0.03125 C 1.703125 -0.03125 2.21875 -0.015625 2.5625 0 L 2.5625 -0.3125 C 1.890625 -0.3125 1.78125 -0.3125 1.78125 -0.75 L 1.78125 -2.59375 C 1.78125 -3.625 2.5 -4.1875 3.125 -4.1875 C 3.765625 -4.1875 3.875 -3.65625 3.875 -3.078125 L 3.875 -0.75 C 3.875 -0.3125 3.765625 -0.3125 3.09375 -0.3125 L 3.09375 0 C 3.4375 -0.015625 3.953125 -0.03125 4.21875 -0.03125 C 4.46875 -0.03125 5 -0.015625 5.328125 0 L 5.328125 -0.3125 C 4.8125 -0.3125 4.5625 -0.3125 4.5625 -0.609375 L 4.5625 -2.515625 C 4.5625 -3.375 4.5625 -3.671875 4.25 -4.03125 C 4.109375 -4.203125 3.78125 -4.40625 3.203125 -4.40625 C 2.359375 -4.40625 1.921875 -3.8125 1.75 -3.421875 L 1.75 -6.921875 L 0.3125 -6.8125 L 0.3125 -6.5 C 1.015625 -6.5 1.09375 -6.4375 1.09375 -5.9375 Z M 1.09375 -0.75 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402977-0-6">
<path style="stroke:none;" d="M 1.71875 -3.984375 L 3.15625 -3.984375 L 3.15625 -4.296875 L 1.71875 -4.296875 L 1.71875 -6.125 L 1.46875 -6.125 C 1.46875 -5.3125 1.171875 -4.25 0.1875 -4.203125 L 0.1875 -3.984375 L 1.03125 -3.984375 L 1.03125 -1.234375 C 1.03125 -0.015625 1.96875 0.109375 2.328125 0.109375 C 3.03125 0.109375 3.3125 -0.59375 3.3125 -1.234375 L 3.3125 -1.796875 L 3.0625 -1.796875 L 3.0625 -1.25 C 3.0625 -0.515625 2.765625 -0.140625 2.390625 -0.140625 C 1.71875 -0.140625 1.71875 -1.046875 1.71875 -1.21875 Z M 1.71875 -3.984375 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402977-0-7">
<path style="stroke:none;" d="M 2.078125 -1.9375 C 2.296875 -1.890625 3.109375 -1.734375 3.109375 -1.015625 C 3.109375 -0.515625 2.765625 -0.109375 1.984375 -0.109375 C 1.140625 -0.109375 0.78125 -0.671875 0.59375 -1.53125 C 0.5625 -1.65625 0.5625 -1.6875 0.453125 -1.6875 C 0.328125 -1.6875 0.328125 -1.625 0.328125 -1.453125 L 0.328125 -0.125 C 0.328125 0.046875 0.328125 0.109375 0.4375 0.109375 C 0.484375 0.109375 0.5 0.09375 0.6875 -0.09375 C 0.703125 -0.109375 0.703125 -0.125 0.890625 -0.3125 C 1.328125 0.09375 1.78125 0.109375 1.984375 0.109375 C 3.125 0.109375 3.59375 -0.5625 3.59375 -1.28125 C 3.59375 -1.796875 3.296875 -2.109375 3.171875 -2.21875 C 2.84375 -2.546875 2.453125 -2.625 2.03125 -2.703125 C 1.46875 -2.8125 0.8125 -2.9375 0.8125 -3.515625 C 0.8125 -3.875 1.0625 -4.28125 1.921875 -4.28125 C 3.015625 -4.28125 3.078125 -3.375 3.09375 -3.078125 C 3.09375 -2.984375 3.1875 -2.984375 3.203125 -2.984375 C 3.34375 -2.984375 3.34375 -3.03125 3.34375 -3.21875 L 3.34375 -4.234375 C 3.34375 -4.390625 3.34375 -4.46875 3.234375 -4.46875 C 3.1875 -4.46875 3.15625 -4.46875 3.03125 -4.34375 C 3 -4.3125 2.90625 -4.21875 2.859375 -4.1875 C 2.484375 -4.46875 2.078125 -4.46875 1.921875 -4.46875 C 0.703125 -4.46875 0.328125 -3.796875 0.328125 -3.234375 C 0.328125 -2.890625 0.484375 -2.609375 0.75 -2.390625 C 1.078125 -2.140625 1.359375 -2.078125 2.078125 -1.9375 Z M 2.078125 -1.9375 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402977-0-8">
<path style="stroke:none;" d="M 1.671875 -3.3125 L 1.671875 -4.40625 L 0.28125 -4.296875 L 0.28125 -3.984375 C 0.984375 -3.984375 1.0625 -3.921875 1.0625 -3.421875 L 1.0625 -0.75 C 1.0625 -0.3125 0.953125 -0.3125 0.28125 -0.3125 L 0.28125 0 C 0.671875 -0.015625 1.140625 -0.03125 1.421875 -0.03125 C 1.8125 -0.03125 2.28125 -0.03125 2.6875 0 L 2.6875 -0.3125 L 2.46875 -0.3125 C 1.734375 -0.3125 1.71875 -0.421875 1.71875 -0.78125 L 1.71875 -2.3125 C 1.71875 -3.296875 2.140625 -4.1875 2.890625 -4.1875 C 2.953125 -4.1875 2.984375 -4.1875 3 -4.171875 C 2.96875 -4.171875 2.765625 -4.046875 2.765625 -3.78125 C 2.765625 -3.515625 2.984375 -3.359375 3.203125 -3.359375 C 3.375 -3.359375 3.625 -3.484375 3.625 -3.796875 C 3.625 -4.109375 3.3125 -4.40625 2.890625 -4.40625 C 2.15625 -4.40625 1.796875 -3.734375 1.671875 -3.3125 Z M 1.671875 -3.3125 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402977-0-9">
<path style="stroke:none;" d="M 4.6875 -2.140625 C 4.6875 -3.40625 3.703125 -4.46875 2.5 -4.46875 C 1.25 -4.46875 0.28125 -3.375 0.28125 -2.140625 C 0.28125 -0.84375 1.3125 0.109375 2.484375 0.109375 C 3.6875 0.109375 4.6875 -0.875 4.6875 -2.140625 Z M 2.5 -0.140625 C 2.0625 -0.140625 1.625 -0.34375 1.359375 -0.8125 C 1.109375 -1.25 1.109375 -1.859375 1.109375 -2.21875 C 1.109375 -2.609375 1.109375 -3.140625 1.34375 -3.578125 C 1.609375 -4.03125 2.078125 -4.25 2.484375 -4.25 C 2.921875 -4.25 3.34375 -4.03125 3.609375 -3.59375 C 3.875 -3.171875 3.875 -2.59375 3.875 -2.21875 C 3.875 -1.859375 3.875 -1.3125 3.65625 -0.875 C 3.421875 -0.421875 2.984375 -0.140625 2.5 -0.140625 Z M 2.5 -0.140625 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402977-0-10">
<path style="stroke:none;" d="M 1.09375 -3.421875 L 1.09375 -0.75 C 1.09375 -0.3125 0.984375 -0.3125 0.3125 -0.3125 L 0.3125 0 C 0.671875 -0.015625 1.171875 -0.03125 1.453125 -0.03125 C 1.703125 -0.03125 2.21875 -0.015625 2.5625 0 L 2.5625 -0.3125 C 1.890625 -0.3125 1.78125 -0.3125 1.78125 -0.75 L 1.78125 -2.59375 C 1.78125 -3.625 2.5 -4.1875 3.125 -4.1875 C 3.765625 -4.1875 3.875 -3.65625 3.875 -3.078125 L 3.875 -0.75 C 3.875 -0.3125 3.765625 -0.3125 3.09375 -0.3125 L 3.09375 0 C 3.4375 -0.015625 3.953125 -0.03125 4.21875 -0.03125 C 4.46875 -0.03125 5 -0.015625 5.328125 0 L 5.328125 -0.3125 C 4.8125 -0.3125 4.5625 -0.3125 4.5625 -0.609375 L 4.5625 -2.515625 C 4.5625 -3.375 4.5625 -3.671875 4.25 -4.03125 C 4.109375 -4.203125 3.78125 -4.40625 3.203125 -4.40625 C 2.46875 -4.40625 2 -3.984375 1.71875 -3.359375 L 1.71875 -4.40625 L 0.3125 -4.296875 L 0.3125 -3.984375 C 1.015625 -3.984375 1.09375 -3.921875 1.09375 -3.421875 Z M 1.09375 -3.421875 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402977-0-11">
<path style="stroke:none;" d="M 1.71875 -3.75 L 1.71875 -4.40625 L 0.28125 -4.296875 L 0.28125 -3.984375 C 0.984375 -3.984375 1.0625 -3.921875 1.0625 -3.484375 L 1.0625 1.171875 C 1.0625 1.625 0.953125 1.625 0.28125 1.625 L 0.28125 1.9375 C 0.625 1.921875 1.140625 1.90625 1.390625 1.90625 C 1.671875 1.90625 2.171875 1.921875 2.515625 1.9375 L 2.515625 1.625 C 1.859375 1.625 1.75 1.625 1.75 1.171875 L 1.75 -0.59375 C 1.796875 -0.421875 2.21875 0.109375 2.96875 0.109375 C 4.15625 0.109375 5.1875 -0.875 5.1875 -2.15625 C 5.1875 -3.421875 4.234375 -4.40625 3.109375 -4.40625 C 2.328125 -4.40625 1.90625 -3.96875 1.71875 -3.75 Z M 1.75 -1.140625 L 1.75 -3.359375 C 2.03125 -3.875 2.515625 -4.15625 3.03125 -4.15625 C 3.765625 -4.15625 4.359375 -3.28125 4.359375 -2.15625 C 4.359375 -0.953125 3.671875 -0.109375 2.9375 -0.109375 C 2.53125 -0.109375 2.15625 -0.3125 1.890625 -0.71875 C 1.75 -0.921875 1.75 -0.9375 1.75 -1.140625 Z M 1.75 -1.140625 "/>
</symbol>
<symbol overflow="visible" id="glyph-1674545912402977-0-12">
<path style="stroke:none;" d="M 3.890625 -0.78125 L 3.890625 0.109375 L 5.328125 0 L 5.328125 -0.3125 C 4.640625 -0.3125 4.5625 -0.375 4.5625 -0.875 L 4.5625 -4.40625 L 3.09375 -4.296875 L 3.09375 -3.984375 C 3.78125 -3.984375 3.875 -3.921875 3.875 -3.421875 L 3.875 -1.65625 C 3.875 -0.78125 3.390625 -0.109375 2.65625 -0.109375 C 1.828125 -0.109375 1.78125 -0.578125 1.78125 -1.09375 L 1.78125 -4.40625 L 0.3125 -4.296875 L 0.3125 -3.984375 C 1.09375 -3.984375 1.09375 -3.953125 1.09375 -3.078125 L 1.09375 -1.578125 C 1.09375 -0.796875 1.09375 0.109375 2.609375 0.109375 C 3.171875 0.109375 3.609375 -0.171875 3.890625 -0.78125 Z M 3.890625 -0.78125 "/>
</symbol>
</g>
<clipPath id="clip-1674545912402977-1">
  <path d="M 229 70 L 284.0625 70 L 284.0625 88 L 229 88 Z M 229 70 "/>
</clipPath>
</defs>
<g id="surface1">
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M -55.009344 22.678594 L -92.392156 22.678594 C -94.595281 22.678594 -96.380437 20.893437 -96.380437 18.694219 L -96.380437 -18.6925 C -96.380437 -20.891719 -94.595281 -22.676875 -92.392156 -22.676875 L -55.009344 -22.676875 C -52.810125 -22.676875 -51.024969 -20.891719 -51.024969 -18.6925 L -51.024969 18.694219 C -51.024969 20.893437 -52.810125 22.678594 -55.009344 22.678594 Z M -55.009344 22.678594 " transform="matrix(1,0,0,-1,141.732,79.37)"/>
<g style="fill:rgb(0%25,0%25,0%25);fill-opacity:1;">
  <use xlink:href="%23glyph-1674545912402977-0-1" x="51.953" y="81.861"/>
</g>
<g style="fill:rgb(0%25,0%25,0%25);fill-opacity:1;">
  <use xlink:href="%23glyph-1674545912402977-0-2" x="58.879027" y="81.861"/>
  <use xlink:href="%23glyph-1674545912402977-0-3" x="63.306425" y="81.861"/>
  <use xlink:href="%23glyph-1674545912402977-0-4" x="66.074046" y="81.861"/>
  <use xlink:href="%23glyph-1674545912402977-0-5" x="71.055366" y="81.861"/>
</g>
<g style="fill:rgb(0%25,0%25,0%25);fill-opacity:1;">
  <use xlink:href="%23glyph-1674545912402977-0-6" x="76.311655" y="81.861"/>
  <use xlink:href="%23glyph-1674545912402977-0-7" x="80.186125" y="81.861"/>
</g>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M 35.701594 56.694219 L -1.685125 56.694219 C -3.884344 56.694219 -5.6695 54.909062 -5.6695 52.709844 L -5.6695 15.323125 C -5.6695 13.123906 -3.884344 11.33875 -1.685125 11.33875 L 35.701594 11.33875 C 37.900813 11.33875 39.685969 13.123906 39.685969 15.323125 L 39.685969 52.709844 C 39.685969 54.909062 37.900813 56.694219 35.701594 56.694219 Z M 35.701594 56.694219 " transform="matrix(1,0,0,-1,141.732,79.37)"/>
<g style="fill:rgb(0%25,0%25,0%25);fill-opacity:1;">
  <use xlink:href="%23glyph-1674545912402977-0-2" x="148.182" y="47.499"/>
  <use xlink:href="%23glyph-1674545912402977-0-8" x="152.609397" y="47.499"/>
  <use xlink:href="%23glyph-1674545912402977-0-8" x="156.511763" y="47.499"/>
  <use xlink:href="%23glyph-1674545912402977-0-9" x="160.414129" y="47.499"/>
  <use xlink:href="%23glyph-1674545912402977-0-8" x="165.395449" y="47.499"/>
</g>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M 35.701594 -11.337031 L -1.685125 -11.337031 C -3.884344 -11.337031 -5.6695 -13.122188 -5.6695 -15.325313 L -5.6695 -52.708125 C -5.6695 -54.91125 -3.884344 -56.6925 -1.685125 -56.6925 L 35.701594 -56.6925 C 37.900813 -56.6925 39.685969 -54.91125 39.685969 -52.708125 L 39.685969 -15.325313 C 39.685969 -13.122188 37.900813 -11.337031 35.701594 -11.337031 Z M 35.701594 -11.337031 " transform="matrix(1,0,0,-1,141.732,79.37)"/>
<g style="fill:rgb(0%25,0%25,0%25);fill-opacity:1;">
  <use xlink:href="%23glyph-1674545912402977-0-3" x="147.117" y="115.744"/>
  <use xlink:href="%23glyph-1674545912402977-0-10" x="149.884621" y="115.744"/>
  <use xlink:href="%23glyph-1674545912402977-0-11" x="155.419864" y="115.744"/>
  <use xlink:href="%23glyph-1674545912402977-0-12" x="160.955107" y="115.744"/>
  <use xlink:href="%23glyph-1674545912402977-0-6" x="166.49035" y="115.744"/>
</g>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M 96.377375 -0.00109375 C 96.377375 3.131719 93.842219 5.670781 90.709406 5.670781 C 87.5805 5.670781 85.041438 3.131719 85.041438 -0.00109375 C 85.041438 -3.13 87.5805 -5.669063 90.709406 -5.669063 C 93.842219 -5.669063 96.377375 -3.13 96.377375 -0.00109375 Z M 96.377375 -0.00109375 " transform="matrix(1,0,0,-1,141.732,79.37)"/>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M 39.982844 -34.016719 C 61.521906 -34.016719 66.889094 -13.751094 85.541438 -2.985469 " transform="matrix(1,0,0,-1,141.732,79.37)"/>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M 39.982844 34.014531 C 61.521906 34.014531 66.889094 13.752812 85.541438 2.983281 " transform="matrix(1,0,0,-1,141.732,79.37)"/>
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M -50.724187 -0.00109375 C -28.735906 -0.00109375 -27.958562 -34.016719 -5.966375 -34.016719 " transform="matrix(1,0,0,-1,141.732,79.37)"/>
<g clip-path="url(%23clip-1674545912402977-1)" clip-rule="nonzero">
<path style="fill:none;stroke-width:0.59776;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%25,0%25,0%25);stroke-opacity:1;stroke-miterlimit:10;" d="M 96.678156 -0.00109375 C 114.365656 -0.00109375 124.346125 -0.00109375 142.033625 -0.00109375 " transform="matrix(1,0,0,-1,141.732,79.37)"/>
</g>
</g>
</svg>

'/><p>Inputs are transformed by nine Gaussian basis functions.</p><pre><code class="language-julia hljs">gbf(μ, s, x) = exp(-(x - μ)^2 / s^2 / 2)
ϕ(x) = [gbf(0.0, 0.1, x) gbf(0.5, 0.1, x) gbf(1.0, 0.1, x) gbf(0.0, 0.5, x) gbf(0.5, 0.5, x) gbf(1.0, 0.5, x) gbf(0.0, 2.5, x) gbf(0.5, 2.5, x) gbf(1.0, 2.5, x)];</code></pre><p>The error term is a centered Gaussian distribution with variance <span>$0.04$</span>.</p><pre><code class="language-julia hljs">&quot;&quot;&quot;
    update(w, x, y)

Update weights `w` given input `x` and output `y`.
&quot;&quot;&quot;
function update(w, x, y)
    types = (GaussRelDom, GaussianRelation)

    generators = Dict(
        weights      =&gt; w,
        input_space  =&gt; GaussRelDom(9),
        output_space =&gt; GaussRelDom(1),
        input        =&gt; GaussianRelation(ϕ(x)),
        output       =&gt; GaussianRelation(GaussianDistribution([y])),
        error        =&gt; GaussianRelation(GaussianDistribution(Matrix(0.04I, 1, 1))),
    )

    functor(types, update_diagram; generators)
end

&quot;&quot;&quot;
    predict(w, x)

Predict an output given weights `w` and an input `x`.

Returns a tuple `(μ, σ)`, representing the center and spread of the prediction.
&quot;&quot;&quot;
function predict(w, x)
    types = (GaussRelDom, GaussianRelation)

    generators = Dict(
        weights      =&gt; w,
        input_space  =&gt; GaussRelDom(9),
        output_space =&gt; GaussRelDom(1),
        input        =&gt; GaussianRelation(ϕ(x)),
        error        =&gt; GaussianRelation(GaussianDistribution(Matrix(0.04, 1, 1))),
    )

    functor(types, predict_diagram; generators)
end

&quot;&quot;&quot;
    plot_predictions(w, xs, ys)

Plot predicted outputs against true outputs and observations.
&quot;&quot;&quot;
function plot_predictions(w, xs, ys)
    D₁ = DataFrame(x=xs, y=ys)
    D₂ = DataFrame(map(range(0, 1, 50)) do x
        Σ, μ, _... = params(predict(w, x))
        ytrue = sin(2π * x)
        ypred = μ[1]
        ymin = ypred - √abs(Σ[1, 1])
        ymax = ypred + √abs(Σ[1, 1])
        (x=x, ytrue=ytrue, ypred=ypred, ymin=ymin, ymax=ymax)
    end)

    plot(
        layer(D₁, x=:x, y=:y, color=[colorant&quot;black&quot;], Geom.point),
        layer(D₂, x=:x, y=:ytrue, color=[colorant&quot;black&quot;], Geom.line),
        layer(D₂, x=:x, y=:ypred, ymin=:ymin, ymax=:ymax, color=[colorant&quot;red&quot;], Geom.line, Geom.ribbon),
        Coord.cartesian(xmin=0, xmax=1, ymin=-2, ymax=2),
        Guide.xlabel(&quot;&quot;),
        Guide.ylabel(&quot;&quot;),
    )
end;</code></pre><p>The prior over weights is a centered Gaussian distribution with covariance matrix <span>$0.5I$</span>.</p><pre><code class="language- hljs">xs = [0.76, 0.50, 0.93, 0.38, 0.22, 0.98, 0.92, 0.39, 0.32, 0.34, 0.46, 0.10, 0.37, 0.08, 0.16, 0.97, 0.69, 0.63, 0.77, 0.23]
ys = [-1.03, -0.02, -0.31, 0.51, 0.80, -0.02, -0.28, 0.79, 0.80, 0.70, 0.21, 0.71, 0.93, 0.58, 0.77, -0.29, -1.11, -0.86, -1.06, 1.00]
ws = []

push!(ws, GaussianRelation(GaussianDistribution(Matrix(0.5I, 9, 9))))
for (x, y) in zip(xs, ys)
    push!(ws, update(ws[end], x, y))
end

p₁ = plot_predictions(ws[2], xs[1:1], ys[1:1])
p₂ = plot_predictions(ws[3], xs[1:2], ys[1:2])
p₃ = plot_predictions(ws[5], xs[1:4], ys[1:4])
p₄ = plot_predictions(ws[21], xs[1:20], ys[1:20])

set_default_plot_size(21cm, 16cm)
gridstack([p₁ p₂; p₃ p₄])</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« AlgebraicInference.jl</a><a class="docs-footer-nextpage" href="../../api/">Library Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 24 January 2023 07:41">Tuesday 24 January 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
