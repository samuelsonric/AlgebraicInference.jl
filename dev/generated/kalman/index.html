<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Kalman Filter · AlgebraicInference.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">AlgebraicInference.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">AlgebraicInference.jl</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../regression/">Linear Regression</a></li><li class="is-active"><a class="tocitem" href>Kalman Filter</a></li><li><a class="tocitem" href="../pixel/">Pixel Arrays</a></li></ul></li><li><a class="tocitem" href="../../api/">Library Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Kalman Filter</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Kalman Filter</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/samuelsonric/AlgebraicInference.jl/blob/master/docs/literate/kalman.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Kalman-Filter"><a class="docs-heading-anchor" href="#Kalman-Filter">Kalman Filter</a><a id="Kalman-Filter-1"></a><a class="docs-heading-anchor-permalink" href="#Kalman-Filter" title="Permalink"></a></h1><pre><code class="language-julia hljs">using AlgebraicInference
using Catlab.Graphics, Catlab.Programs, Catlab.WiringDiagrams
using Distributions
using FillArrays
using LinearAlgebra
using Random</code></pre><p>A Kalman filter with <span>$n$</span> steps is a probability distribution over states <span>$(x_1, \dots, x_n)$</span> and measurements <span>$(y_1, \dots, y_n)$</span> determined by the equations</p><p class="math-container">\[    p(x_{i+1} \mid x_i) = \mathcal{N}(Ax_i, P)\]</p><p>and</p><p class="math-container">\[    p(y_i \mid x_i) = \mathcal{N}(Bx_i, Q).\]</p><pre><code class="language-julia hljs">θ = π / 15

A = [
    cos(θ) -sin(θ)
    sin(θ)  cos(θ)
]

B = [
    1.3 0.0
    0.0 0.7
]

P = [
    0.05 0.0
    0.0 0.05
]

Q = [
    10.0 0.0
    0.0 10.0
]


function generate_data(n::Integer; seed::Integer=42)
    Random.seed!(seed)
    data = Matrix{Float64}(undef, 2, n)

    N₁ = MvNormal(P)
    N₂ = MvNormal(Q)

    x = Zeros(2)

    for i in 1:n
        x = rand(N₁) + A * x
        data[:, i] .= rand(N₂) + B * x
    end

    data
end;</code></pre><p>The <em>prediction problem</em> involves finding the posterior mean and covariance of the state <span>$x_{n + 1}$</span> given observations of <span>$(y_1, \dots, y_n)$</span>.</p><pre><code class="language-julia hljs">function make_diagram(n::Integer)
    outer_ports = [&quot;X&quot;]

    uwd = TypedRelationDiagram{String, String, Tuple{Int, Int}}(outer_ports)

    x = add_junction!(uwd, &quot;X&quot;; variable=(1, 1))
    y = add_junction!(uwd, &quot;Y&quot;; variable=(2, 1))

    state   = add_box!(uwd, [&quot;X&quot;];      name=&quot;state&quot;)
    predict = add_box!(uwd, [&quot;X&quot;, &quot;X&quot;]; name=&quot;predict&quot;)
    measure = add_box!(uwd, [&quot;X&quot;, &quot;Y&quot;]; name=&quot;measure&quot;)
    context = add_box!(uwd, [&quot;Y&quot;];      name=&quot;y1&quot;)

    set_junction!(uwd, (state,   1), x)
    set_junction!(uwd, (predict, 1), x)
    set_junction!(uwd, (measure, 1), x)
    set_junction!(uwd, (measure, 2), y)
    set_junction!(uwd, (context, 1), y)

    for i in 2:n
        x = add_junction!(uwd, &quot;X&quot;; variable=(1, i))
        y = add_junction!(uwd, &quot;Y&quot;; variable=(2, i))

        set_junction!(uwd, (predict, 2), x)

        predict = add_box!(uwd, [&quot;X&quot;, &quot;X&quot;]; name=&quot;predict&quot;)
        measure = add_box!(uwd, [&quot;X&quot;, &quot;Y&quot;]; name=&quot;measure&quot;)
        context = add_box!(uwd, [&quot;Y&quot;];      name=&quot;y$i&quot;)

        set_junction!(uwd, (predict, 1), x)
        set_junction!(uwd, (measure, 1), x)
        set_junction!(uwd, (measure, 2), y)
        set_junction!(uwd, (context, 1), y)
    end

    i = n + 1
    x = add_junction!(uwd, &quot;X&quot;; variable=(1, i))

    set_junction!(uwd, (0,       1), x)
    set_junction!(uwd, (predict, 2), x)

    uwd
end

to_graphviz(make_diagram(5), box_labels=:name; junction_labels=:variable)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="520pt" height="335pt"
 viewBox="0.00 0.00 519.75 335.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 331.33)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-331.33 515.75,-331.33 515.75,4 -4,4"/>
<!-- n1 -->
<g id="box1" class="node">
<title>n1</title>
<ellipse fill="none" stroke="black" cx="58.26" cy="-176.24" rx="26.48" ry="18"/>
<text text-anchor="middle" x="58.26" y="-172.54" font-family="Serif" font-size="14.00">state</text>
</g>
<!-- n18 -->
<!-- junction -->
<g id="junction1" class="node">
<title>n18</title>
<ellipse fill="black" stroke="black" cx="94.12" cy="-196.25" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="72.62" y="-202.55" font-family="Serif" font-size="14.00">(1, 1)</text>
</g>
<!-- n1&%2345;&%2345;n18 -->
<g id="edge1" class="edge">
<title>n1&%2345;&%2345;n18</title>
<path fill="none" stroke="black" d="M79.12,-187.88C84.3,-190.77 89.14,-193.47 91.86,-194.99"/>
</g>
<!-- n2 -->
<g id="box2" class="node">
<title>n2</title>
<ellipse fill="none" stroke="black" cx="130.19" cy="-176.19" rx="35.14" ry="18"/>
<text text-anchor="middle" x="130.19" y="-172.49" font-family="Serif" font-size="14.00">predict</text>
</g>
<!-- n2&%2345;&%2345;n18 -->
<g id="edge2" class="edge">
<title>n2&%2345;&%2345;n18</title>
<path fill="none" stroke="black" d="M105.93,-189.68C102.06,-191.84 98.62,-193.75 96.46,-194.95"/>
</g>
<!-- n20 -->
<!-- junction -->
<g id="junction3" class="node">
<title>n20</title>
<ellipse fill="black" stroke="black" cx="159.56" cy="-145.55" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="138.06" y="-146.85" font-family="Serif" font-size="14.00">(1, 2)</text>
</g>
<!-- n2&%2345;&%2345;n20 -->
<g id="edge6" class="edge">
<title>n2&%2345;&%2345;n20</title>
<path fill="none" stroke="black" d="M145.91,-159.79C150.71,-154.78 155.36,-149.93 157.8,-147.38"/>
</g>
<!-- n3 -->
<g id="box3" class="node">
<title>n3</title>
<ellipse fill="none" stroke="black" cx="75.29" cy="-231.9" rx="41.41" ry="18"/>
<text text-anchor="middle" x="75.29" y="-228.2" font-family="Serif" font-size="14.00">measure</text>
</g>
<!-- n3&%2345;&%2345;n18 -->
<g id="edge3" class="edge">
<title>n3&%2345;&%2345;n18</title>
<path fill="none" stroke="black" d="M84.7,-214.07C87.94,-207.95 91.18,-201.82 92.88,-198.59"/>
</g>
<!-- n19 -->
<!-- junction -->
<g id="junction2" class="node">
<title>n19</title>
<ellipse fill="black" stroke="black" cx="45.88" cy="-256.77" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="62.38" y="-263.07" font-family="Serif" font-size="14.00">(2, 1)</text>
</g>
<!-- n3&%2345;&%2345;n19 -->
<g id="edge4" class="edge">
<title>n3&%2345;&%2345;n19</title>
<path fill="none" stroke="black" d="M56.16,-248.07C52.83,-250.89 49.83,-253.43 47.94,-255.02"/>
</g>
<!-- n4 -->
<g id="box4" class="node">
<title>n4</title>
<ellipse fill="none" stroke="black" cx="18" cy="-281.44" rx="18" ry="18"/>
<text text-anchor="middle" x="18" y="-277.74" font-family="Serif" font-size="14.00">y1</text>
</g>
<!-- n4&%2345;&%2345;n19 -->
<g id="edge5" class="edge">
<title>n4&%2345;&%2345;n19</title>
<path fill="none" stroke="black" d="M31.61,-269.4C36.48,-265.09 41.4,-260.74 44,-258.44"/>
</g>
<!-- n5 -->
<g id="box5" class="node">
<title>n5</title>
<ellipse fill="none" stroke="black" cx="202.5" cy="-147.67" rx="35.14" ry="18"/>
<text text-anchor="middle" x="202.5" y="-143.97" font-family="Serif" font-size="14.00">predict</text>
</g>
<!-- n5&%2345;&%2345;n20 -->
<g id="edge7" class="edge">
<title>n5&%2345;&%2345;n20</title>
<path fill="none" stroke="black" d="M167.04,-145.91C165.09,-145.82 163.42,-145.74 162.15,-145.67"/>
</g>
<!-- n22 -->
<!-- junction -->
<g id="junction5" class="node">
<title>n22</title>
<ellipse fill="black" stroke="black" cx="244.97" cy="-139.74" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="261.47" y="-126.04" font-family="Serif" font-size="14.00">(1, 3)</text>
</g>
<!-- n5&%2345;&%2345;n22 -->
<g id="edge11" class="edge">
<title>n5&%2345;&%2345;n22</title>
<path fill="none" stroke="black" d="M235.96,-141.42C238.6,-140.93 240.85,-140.51 242.44,-140.22"/>
</g>
<!-- n6 -->
<g id="box6" class="node">
<title>n6</title>
<ellipse fill="none" stroke="black" cx="138.92" cy="-107.84" rx="41.41" ry="18"/>
<text text-anchor="middle" x="138.92" y="-104.14" font-family="Serif" font-size="14.00">measure</text>
</g>
<!-- n6&%2345;&%2345;n20 -->
<g id="edge8" class="edge">
<title>n6&%2345;&%2345;n20</title>
<path fill="none" stroke="black" d="M148.51,-125.37C152.39,-132.45 156.4,-139.77 158.35,-143.33"/>
</g>
<!-- n21 -->
<!-- junction -->
<g id="junction4" class="node">
<title>n21</title>
<ellipse fill="black" stroke="black" cx="116.62" cy="-73.89" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="95.12" y="-75.19" font-family="Serif" font-size="14.00">(2, 2)</text>
</g>
<!-- n6&%2345;&%2345;n21 -->
<g id="edge9" class="edge">
<title>n6&%2345;&%2345;n21</title>
<path fill="none" stroke="black" d="M127.51,-90.47C123.74,-84.73 120.01,-79.05 118.05,-76.06"/>
</g>
<!-- n7 -->
<g id="box7" class="node">
<title>n7</title>
<ellipse fill="none" stroke="black" cx="94.2" cy="-42.24" rx="18" ry="18"/>
<text text-anchor="middle" x="94.2" y="-38.54" font-family="Serif" font-size="14.00">y2</text>
</g>
<!-- n7&%2345;&%2345;n21 -->
<g id="edge10" class="edge">
<title>n7&%2345;&%2345;n21</title>
<path fill="none" stroke="black" d="M104.62,-56.96C108.65,-62.64 112.81,-68.51 115.02,-71.63"/>
</g>
<!-- n8 -->
<g id="box8" class="node">
<title>n8</title>
<ellipse fill="none" stroke="black" cx="280.28" cy="-164.65" rx="35.14" ry="18"/>
<text text-anchor="middle" x="280.28" y="-160.95" font-family="Serif" font-size="14.00">predict</text>
</g>
<!-- n8&%2345;&%2345;n22 -->
<g id="edge12" class="edge">
<title>n8&%2345;&%2345;n22</title>
<path fill="none" stroke="black" d="M259.33,-149.88C254.34,-146.36 249.72,-143.09 247.13,-141.27"/>
</g>
<!-- n24 -->
<!-- junction -->
<g id="junction7" class="node">
<title>n24</title>
<ellipse fill="black" stroke="black" cx="316.85" cy="-187.66" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="295.35" y="-193.96" font-family="Serif" font-size="14.00">(1, 4)</text>
</g>
<!-- n8&%2345;&%2345;n24 -->
<g id="edge16" class="edge">
<title>n8&%2345;&%2345;n24</title>
<path fill="none" stroke="black" d="M302.82,-178.83C307.52,-181.79 311.83,-184.5 314.4,-186.11"/>
</g>
<!-- n9 -->
<g id="box9" class="node">
<title>n9</title>
<ellipse fill="none" stroke="black" cx="252.88" cy="-97.65" rx="41.41" ry="18"/>
<text text-anchor="middle" x="252.88" y="-93.95" font-family="Serif" font-size="14.00">measure</text>
</g>
<!-- n9&%2345;&%2345;n22 -->
<g id="edge13" class="edge">
<title>n9&%2345;&%2345;n22</title>
<path fill="none" stroke="black" d="M249.48,-115.75C247.94,-123.95 246.28,-132.76 245.47,-137.06"/>
</g>
<!-- n23 -->
<!-- junction -->
<g id="junction6" class="node">
<title>n23</title>
<ellipse fill="black" stroke="black" cx="258.31" cy="-57.12" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="236.81" y="-63.42" font-family="Serif" font-size="14.00">(2, 3)</text>
</g>
<!-- n9&%2345;&%2345;n23 -->
<g id="edge14" class="edge">
<title>n9&%2345;&%2345;n23</title>
<path fill="none" stroke="black" d="M255.34,-79.29C256.35,-71.75 257.41,-63.85 257.94,-59.83"/>
</g>
<!-- n10 -->
<g id="box10" class="node">
<title>n10</title>
<ellipse fill="none" stroke="black" cx="262.04" cy="-18" rx="18" ry="18"/>
<text text-anchor="middle" x="262.04" y="-14.3" font-family="Serif" font-size="14.00">y3</text>
</g>
<!-- n10&%2345;&%2345;n23 -->
<g id="edge15" class="edge">
<title>n10&%2345;&%2345;n23</title>
<path fill="none" stroke="black" d="M260.3,-36.19C259.62,-43.37 258.91,-50.8 258.55,-54.58"/>
</g>
<!-- n11 -->
<g id="box11" class="node">
<title>n11</title>
<ellipse fill="none" stroke="black" cx="358.47" cy="-176.55" rx="35.14" ry="18"/>
<text text-anchor="middle" x="358.47" y="-172.85" font-family="Serif" font-size="14.00">predict</text>
</g>
<!-- n11&%2345;&%2345;n24 -->
<g id="edge17" class="edge">
<title>n11&%2345;&%2345;n24</title>
<path fill="none" stroke="black" d="M326.93,-184.97C323.84,-185.79 321.19,-186.5 319.39,-186.98"/>
</g>
<!-- n26 -->
<!-- junction -->
<g id="junction9" class="node">
<title>n26</title>
<ellipse fill="black" stroke="black" cx="400.76" cy="-171.81" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="422.26" y="-173.11" font-family="Serif" font-size="14.00">(1, 5)</text>
</g>
<!-- n11&%2345;&%2345;n26 -->
<g id="edge21" class="edge">
<title>n11&%2345;&%2345;n26</title>
<path fill="none" stroke="black" d="M393,-172.68C395.01,-172.46 396.75,-172.26 398.06,-172.11"/>
</g>
<!-- n12 -->
<g id="box12" class="node">
<title>n12</title>
<ellipse fill="none" stroke="black" cx="313.87" cy="-230.11" rx="41.41" ry="18"/>
<text text-anchor="middle" x="313.87" y="-226.41" font-family="Serif" font-size="14.00">measure</text>
</g>
<!-- n12&%2345;&%2345;n24 -->
<g id="edge18" class="edge">
<title>n12&%2345;&%2345;n24</title>
<path fill="none" stroke="black" d="M315.15,-211.86C315.73,-203.59 316.36,-194.71 316.66,-190.36"/>
</g>
<!-- n25 -->
<!-- junction -->
<g id="junction8" class="node">
<title>n25</title>
<ellipse fill="black" stroke="black" cx="315.05" cy="-270.56" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="293.55" y="-276.86" font-family="Serif" font-size="14.00">(2, 4)</text>
</g>
<!-- n12&%2345;&%2345;n25 -->
<g id="edge19" class="edge">
<title>n12&%2345;&%2345;n25</title>
<path fill="none" stroke="black" d="M314.41,-248.44C314.63,-255.97 314.86,-263.85 314.97,-267.86"/>
</g>
<!-- n13 -->
<g id="box13" class="node">
<title>n13</title>
<ellipse fill="none" stroke="black" cx="319.25" cy="-309.33" rx="18" ry="18"/>
<text text-anchor="middle" x="319.25" y="-305.63" font-family="Serif" font-size="14.00">y4</text>
</g>
<!-- n13&%2345;&%2345;n25 -->
<g id="edge20" class="edge">
<title>n13&%2345;&%2345;n25</title>
<path fill="none" stroke="black" d="M317.3,-291.31C316.54,-284.35 315.77,-277.15 315.35,-273.34"/>
</g>
<!-- n14 -->
<g id="box14" class="node">
<title>n14</title>
<ellipse fill="none" stroke="black" cx="424.62" cy="-137.48" rx="35.14" ry="18"/>
<text text-anchor="middle" x="424.62" y="-133.78" font-family="Serif" font-size="14.00">predict</text>
</g>
<!-- n14&%2345;&%2345;n26 -->
<g id="edge22" class="edge">
<title>n14&%2345;&%2345;n26</title>
<path fill="none" stroke="black" d="M412.69,-154.64C408.59,-160.55 404.49,-166.45 402.32,-169.56"/>
</g>
<!-- n28 -->
<!-- junction -->
<g id="junction11" class="node">
<title>n28</title>
<ellipse fill="black" stroke="black" cx="453.28" cy="-110.28" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="431.78" y="-96.58" font-family="Serif" font-size="14.00">(1, 6)</text>
</g>
<!-- n14&%2345;&%2345;n28 -->
<g id="edge26" class="edge">
<title>n14&%2345;&%2345;n28</title>
<path fill="none" stroke="black" d="M441.63,-121.34C445.48,-117.68 449.07,-114.28 451.22,-112.24"/>
</g>
<!-- n15 -->
<g id="box15" class="node">
<title>n15</title>
<ellipse fill="none" stroke="black" cx="429.71" cy="-202.11" rx="41.41" ry="18"/>
<text text-anchor="middle" x="429.71" y="-198.41" font-family="Serif" font-size="14.00">measure</text>
</g>
<!-- n15&%2345;&%2345;n26 -->
<g id="edge23" class="edge">
<title>n15&%2345;&%2345;n26</title>
<path fill="none" stroke="black" d="M413.54,-185.19C409.19,-180.63 405.04,-176.3 402.71,-173.85"/>
</g>
<!-- n27 -->
<!-- junction -->
<g id="junction10" class="node">
<title>n27</title>
<ellipse fill="black" stroke="black" cx="460.76" cy="-226.4" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="439.26" y="-232.7" font-family="Serif" font-size="14.00">(2, 5)</text>
</g>
<!-- n15&%2345;&%2345;n27 -->
<g id="edge24" class="edge">
<title>n15&%2345;&%2345;n27</title>
<path fill="none" stroke="black" d="M449.9,-217.9C453.42,-220.65 456.59,-223.13 458.58,-224.69"/>
</g>
<!-- n16 -->
<g id="box16" class="node">
<title>n16</title>
<ellipse fill="none" stroke="black" cx="493.75" cy="-245.08" rx="18" ry="18"/>
<text text-anchor="middle" x="493.75" y="-241.38" font-family="Serif" font-size="14.00">y5</text>
</g>
<!-- n16&%2345;&%2345;n27 -->
<g id="edge25" class="edge">
<title>n16&%2345;&%2345;n27</title>
<path fill="none" stroke="black" d="M478.03,-236.18C472.19,-232.87 466.22,-229.48 463.05,-227.69"/>
</g>
<!-- n17 -->
<!-- n17&%2345;&%2345;n28 -->
<g id="edge27" class="edge">
<title>n17&%2345;&%2345;n28</title>
<path fill="none" stroke="black" d="M482.23,-87.05C478.52,-90.03 461.73,-103.5 455.56,-108.45"/>
</g>
</g>
</svg>
'/><p>We generate <span>$100$</span> points of data and solve the prediction problem.</p><pre><code class="language-julia hljs">n = 100
diagram = make_diagram(n)
data = generate_data(n)

hom_map = Dict{String, DenseGaussianSystem{Float64}}(
    &quot;state&quot; =&gt; normal(Zeros(2), 100I(2)),
    &quot;predict&quot; =&gt; kernel(A, Zeros(2), P),
    &quot;measure&quot; =&gt; kernel(B, Zeros(2), Q))

ob_map = Dict(
    &quot;X&quot; =&gt; 2,
    &quot;Y&quot; =&gt; 2)

for i in 1:n
    hom_map[&quot;y$i&quot;] = normal(data[:, i], Zeros(2, 2))
end

problem = InferenceProblem(diagram, hom_map, ob_map)

Σ = solve(problem)

round.(mean(Σ); digits=4)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 -0.8625
  0.7602</code></pre><pre><code class="language-julia hljs">round.(cov(Σ); digits=4)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2 Matrix{Float64}:
  0.7037  -0.063
 -0.063    0.7193</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../regression/">« Linear Regression</a><a class="docs-footer-nextpage" href="../pixel/">Pixel Arrays »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 26 September 2023 03:30">Tuesday 26 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
